<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:TransactionQL.DesktopApp.ViewModels"
        xmlns:v="using:TransactionQL.DesktopApp.Views"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:dd="using:TransactionQL.DesktopApp"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="clr-namespace:Projektanker.Icons.Avalonia;assembly=Projektanker.Icons.Avalonia"
        mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="550"
        Width="1000"
        x:Class="TransactionQL.DesktopApp.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="TransactionQL Desktop"
        Icon="/Assets/lion.ico"
        ExtendClientAreaToDecorationsHint="True"
        DataContext="{x:Static dd:DesignData.MainWindow}">
  <Window.Styles>
    <StyleInclude Source="/Assets/Styles.axaml" />
  </Window.Styles>
  <Panel>
    <Grid RowDefinitions="Auto,Auto,*" ColumnDefinitions="*">
      <Grid Grid.Row="1" ColumnDefinitions="*,Auto">
        <Border Grid.Column="0" Name="Toolbar">
          <Grid ColumnDefinitions="*,*,*">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Spacing="20">
              <Image Height="12" Width="12" Source="/Assets/lion.png"/>
              <Button Click="Open" HotKey="Ctrl+O" Classes="IconAction" i:Attached.Icon="fa-regular fa-folder-open">
                <ToolTip.Tip>Open Bank Transactions (Ctrl+O)</ToolTip.Tip>
              </Button>
              <Button Command="{Binding SaveStateCommand}" Classes="IconAction" HotKey="Ctrl+S"
                      i:Attached.Icon="fa-regular fa-floppy-disk">
                <ToolTip.Tip>Save Progress (Ctrl+S)</ToolTip.Tip>
              </Button>
              <TextBlock Text=
                         "{Binding LastSaved}" VerticalAlignment="Center" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Grid.Column="1">
              <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                          IsVisible="{Binding !IsDone}">
                <TextBlock Text="{Binding NumberOfValidTransactions}" />
                <TextBlock Text="/" />
                <TextBlock Text="{Binding BankTransactions.Count}" />
              </StackPanel>
              <Button Grid.Column="1"
                      Classes="Primary"
                      IsVisible="{Binding IsDone}"
                      Command="{Binding SaveCommand}" HotKey="Ctrl+Alt+S">
                <StackPanel Orientation="Horizontal" Spacing="10">
                  <i:Icon Value="fa-check" VerticalAlignment="Center" />
                  <TextBlock Text="Export" VerticalAlignment="Center"/>
                </StackPanel>
              </Button>
              <Button Classes="Hidden" Name="CarouselPrevious" HotKey="Ctrl+Q" i:Attached.Icon="fa-angle-left">
                <ToolTip.Tip>Previous (Ctrl+Q)</ToolTip.Tip>
              </Button>
              <Button Classes="Hidden" Name="CarouselNext" HotKey="Ctrl+E" i:Attached.Icon="fa-angle-right">
                <ToolTip.Tip>Next (Ctrl+E)</ToolTip.Tip>
              </Button>
            </StackPanel>
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Grid.Column="2">
            </StackPanel>
          </Grid>
        </Border>
      </Grid>
      <Grid Name="Main" ColumnDefinitions="5*,3*"
            Grid.Row="2" >
        <Carousel Grid.Column="0"
                  Name="BankTransactionCarousel"
                  ItemsSource="{Binding BankTransactions}"
                  SelectedIndex="{Binding BankTransactionIndex}"
                  SelectionChanged="BankTransactionCarousel_OnSelectionChanged"
                  WrapSelection="True">
          <Carousel.Styles>
            <Style Selector="ItemsPresenter">
              <Setter Property="(KeyboardNavigation.TabNavigation)" Value="Continue" />
            </Style>
          </Carousel.Styles>
          <Carousel.ItemTemplate>
            <DataTemplate>
              <v:PaymentDetails DataContext="{Binding}" Padding="20" />
            </DataTemplate>
          </Carousel.ItemTemplate>
        </Carousel>
        <Border Name="Transactions" Grid.Column="1">
          <Border Classes="Card">
            <DockPanel>
              <Border Classes="CardAccent" DockPanel.Dock="Top">
              </Border>
              <ListBox DockPanel.Dock="Bottom"
                       SelectionMode="Single"
                       Name="TransactionsList" ItemsSource="{Binding BankTransactions}"
                       SelectedIndex="{Binding BankTransactionIndex}" >
                <ListBox.ItemTemplate>
                  <DataTemplate>
                    <Border Classes="Indicator" Classes.ErrorBorder="{Binding HasError}">
                      <TextBlock Text="{Binding Title}" HorizontalAlignment="Stretch" />
                    </Border>
                  </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
            </DockPanel>
          </Border>
        </Border>
      </Grid>
      <DockPanel VerticalAlignment="Bottom" Grid.Row="3">
        <ProgressBar Minimum="0" Maximum="{Binding BankTransactions.Count}"
                     Value="{Binding NumberOfValidTransactions}"
                     MinHeight="2"
                     DockPanel.Dock="Bottom" HorizontalAlignment="Stretch"
                     CornerRadius="0"/>
      </DockPanel>
    </Grid>
  </Panel>
</Window>